# Moview

## ë°°í¬

[ì›¹ì‚¬ì´íŠ¸](https://mo-view.netlify.app/)

## í”„ë¡œì íŠ¸ ì†Œê°œ

TMDB APIë¥¼ ì´ìš©í•˜ì—¬ ê°œë°œí•œ ì˜í™”/TVí”„ë¡œê·¸ë¨ ì†Œê°œ ì•±ì…ë‹ˆë‹¤. ì¶”ì²œë³„ë¡œ ì˜í™”/TV ë¦¬ìŠ¤íŠ¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì»¨í…ì¸ ì— ëŒ€í•œ ì„¸ë¶€ë‚´ìš©ì„ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©° ê²€ìƒ‰ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

## ê¸°ìˆ  ìŠ¤íƒ

- React
- Typescript
- Styled-components
- Recoil
- storybook

## í”„ë¡œì íŠ¸ë¥¼ í†µí•´ ë°°ìš´ì /ì•„ì‰¬ìš´ì 

### ì•„í† ë¯¹ ë””ìì¸ íŒ¨í„´ì„ ì ìš©í•œ ê²½í—˜

ì»´í¬ë„ŒíŠ¸ì˜ ì¬ì‚¬ìš©ì„ ìœ„í•œ ì•„í† ë¯¹ ë””ìì¸ íŒ¨í„´ì„ ì ìš©í•´ë³´ì•˜ìŠµë‹ˆë‹¤. ì»´í¬ë„ŒíŠ¸ë¥¼ atom/molecules/organism/template/page ë‹¨ìœ„ë¡œ ë‚˜ëˆ„ëŠ” ê²ƒì„ ì‹œì‘ìœ¼ë¡œ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ê³ ì í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ëŸ¬ë‹ì»¤ë¸Œê°€ ìƒê°ë³´ë‹¤ ë†’ê³  ì°¸ê³ í•  ìˆ˜ ìˆëŠ” ë ˆí¼ëŸ°ìŠ¤ê°€ ë§ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. êµ¬í˜„í•˜ê³ ì í•˜ëŠ” ë§ˆìŒì´ ì•ì„œ íŒ¨í„´ì„ ì„±ê³µì ìœ¼ë¡œ ì ìš©ì‹œí‚¤ì§€ëŠ” ëª»í•œê²ƒ ê°™ì§€ë§Œ ì•„í† ë¯¹ ë””ìì¸ íŒ¨í„´ì„ ìœ„í•œ ëª‡ê°€ì§€ ê·œì¹™ì„ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ìŒì— ì•„í† ë¯¹ ë””ìì¸ íŒ¨í„´ì„ ì ìš©í• ë•ŒëŠ” ì•„ë˜ ì‚¬í•­ì„ ì§€í‚¤ë©´ì„œ ê°œë°œí•´ë³¼ ì˜ˆì •ì…ë‹ˆë‹¤.

1. ìµœì†Œí•œ Atomì€ ì¬ì‚¬ìš©ì„±ì´ ë†’ë„ë¡ ì„¤ê³„í•˜ê³ , ìƒìœ„ ë‹¨ìœ„ ì»´í¬ë„ŒíŠ¸ëŠ” ìœµí†µì„±ìˆê²Œ ì„¤ê³„í•  ìˆ˜ ìˆë‹¤.
2. ë„¤ì´ë°ì— ê·œì¹™ì„ ì •í•´ í•œ ëˆˆì— ì–´ë–¤ ìš©ë„ì¸ì§€ ì•Œì•„ë³¼ ìˆ˜ ìˆë„ë¡ í•œë‹¤.
3. ì„œë¹„ìŠ¤ì˜ ëª¨ë“  í˜ì´ì§€ë¥¼ êµ¬ìƒí•˜ê³  ê·¸ ì´í›„ì— ì›ìë¥¼ ë½‘ì•„ë‚¸ë‹¤.
4. Atom
   1. ìœ„ì¹˜ë¥¼ ê²°ì •í•˜ëŠ” ìŠ¤íƒ€ì¼ ì†ì„±ì€ propsë¡œ ë°›ì•„ ì¬ì‚¬ìš©ì„±ì„ ë†’ì¸ë‹¤.
   2. ì„œë¹„ìŠ¤ ì „ì²´ì—ì„œ ì¼ê´€ì ìœ¼ë¡œ ì ìš©ë˜ëŠ” ìƒ‰ì´ë‚˜ í°íŠ¸ í¬ê¸°ëŠ” propsë¡œ ì£¼ì…í•˜ì§€ ì•ŠëŠ”ë‹¤.
   3. ë™ì ì¸ íš¨ê³¼ê°€ í•„ìš”í•œ atomì¸ ê²½ìš° isAnimation ë“±ì˜ propsë¥¼ ì „ë‹¬ë°›ì•„ ì• ë‹ˆë©”ì´ì…˜ ì—¬ë¶€ë¥¼ ê²°ì •í•˜ë„ë¡ í•œë‹¤.
   4. ë¡œì§ê³¼ì˜ ì—°ê²°ì´ í•„ìš”í•œ atomì˜ ê²½ìš° ì»¤ìŠ¤í…€ í›…ì„ ë§Œë“¤ì–´ ë°˜í™˜í•œ í•¨ìˆ˜ë¥¼ propsë¡œ ì „ë‹¬í•œë‹¤.
5. Molecules
   1. ì„œë¹„ìŠ¤ì—ì„œ ë³€í•˜ì§€ ì•ŠëŠ” ë°ì´í„°ëŠ” Molecule ì—ì„œ ì£¼ì…í•´ prop drillingì„ ë°©ì§€í•œë‹¤.
   2. í•œ ì¢…ë¥˜ì˜ atomìœ¼ë¡œë„ moleculeì„ ë§Œë“¤ì–´ë„ ìƒê´€ ì—†ë‹¤.

> ì°¸ê³ í•œ ë ˆí¼ëŸ°ìŠ¤
>
> [ë¦¬ì•¡íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì¡° - ì•„í† ë¯¹ ë””ìì¸](https://ui.toast.com/weekly-pick/ko_20200213)
>
> [atomic design íŒŒí—¤ì¹˜ê¸°](https://simsimjae.tistory.com/407)
>
> [ì•„í† ë¯¹ ë””ìì¸(Atomic Design) ì ìš©ê¸° : í•œê³„ì , ë‹¨ì ](https://sumini.dev/guide/009-dont-use-atomic-design/)
>
> [ì•„í† ë¯¹ ë””ìì¸ íŒ¨í„´ì„ ì‹¤ì²œí•˜ëŠ” ë°©ë²•-1](https://medium.com/@plantstoen/%EC%95%84%ED%86%A0%EB%AF%B9-%EB%94%94%EC%9E%90%EC%9D%B8-%ED%8C%A8%ED%84%B4%EC%9D%84-%EC%8B%A4%EC%B2%9C%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95-1-5e8aada05209)

### Intersection Observer APIë¥¼ í™œìš©í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ë ˆì´ì§€ ë¡œë”©

ì»´í¬ë„ŒíŠ¸ì—ì„œ ê°œë³„ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ useIntersectë¼ëŠ” ì»¤ìŠ¤í…€ í›…ì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.

```typescript
// useIntersect hook
const useIntersect = (
  elementRef: RefObject<Element>,
  {
    threshold = 0,
    root = null,
    rootMargin = "0%",
    freezeOnceVisible = false,
  }: Args
): IntersectionObserverEntry | undefined => {
  const [entry, setEntry] = useState<IntersectionObserverEntry>();
  const frozen = entry?.isIntersecting && freezeOnceVisible;

  const updateEntry = ([entry]: IntersectionObserverEntry[]): void => {
    setEntry(entry);
  };

  useEffect(() => {
    const node = elementRef?.current;
    const hasIOSupport = !!window.IntersectionObserver;

    if (!hasIOSupport || frozen || !node) return;

    const observerParams = { threshold, root, rootMargin };

    const observer = new IntersectionObserver(updateEntry, observerParams);

    observer.observe(node);

    return () => observer.disconnect();
  }, [elementRef, threshold, root, rootMargin, frozen]);
  return entry;
};
```

`useIntersect`ëŠ” `Intersection Observer`ê°€ êµ¬ë…ì¤‘ì¸ `DOM Element`ì˜ `entry`ê°ì²´ë¥¼ ìƒíƒœë¡œ ê°–ìŠµë‹ˆë‹¤.

`effect Hook`ì—ì„œëŠ” `IO`(í’€ë„¤ì„ì´ ê¸¸ì–´ì„œ ì¤„ì—¬ì„œ ë¶€ë¥´ê² ìŠµë‹ˆë‹¤)ê°€ ì‹¤í–‰í•  ì½œë°±ê³¼ ì˜µì…˜ê°ì²´ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œí•˜ëŠ” ìƒì„±ì í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ `IO` ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê³  `ref`ë¡œ ì „ë‹¬ë°›ì€ `DOM`ê°ì²´ë¥¼ êµ¬ë…í•©ë‹ˆë‹¤. ë·°í¬íŠ¸ì— í•´ë‹¹ `element`ê°€ êµì°¨í•œ ê²½ìš° `entry`ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤. return ì‹œì—ëŠ” êµ¬ë…í–ˆë˜ `dom element`ë¥¼ í•´ì œí•˜ì—¬ `cleanup`í•©ë‹ˆë‹¤.

`entry`ë¥¼ ë°˜í™˜í•˜ì—¬ ì»´í¬ë„ŒíŠ¸ëŠ” `entry`ì˜ í”„ë¡œí¼í‹°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ hookì„ ì‚¬ìš©í•˜ëŠ” ì´ë¯¸ì§€ ì»´í¬ë„ŒíŠ¸ëŠ” `entry`ì˜ `isIntersecting` í”„ë¡œí¼í‹°ê°€ ì°¸ì¼ ê²½ìš° `data-src` ì†ì„±ì„ `src` ì†ì„±ì— í• ë‹¹í•´ ì‹¤ì œ ì´ë¯¸ì§€ë¥¼ ë¡œë“œí•©ë‹ˆë‹¤.

> ì°¸ê³ í•œ ë ˆí¼ëŸ°ìŠ¤
>
> [https://usehooks-typescript.com/react-hook/use-intersection-observer](https://usehooks-typescript.com/react-hook/use-intersection-observer)

### Suspense, ErrorBoundaryë¥¼ ì‚¬ìš©í•œ ê²½í—˜

í† ìŠ¤ì—ì„œ ì§„í–‰í•œ ì˜¨ë¼ì¸ ì»¨í¼ëŸ°ìŠ¤ ì„¸ì…˜ì¤‘ **ë¹„ë™ê¸°ë¥¼ ìš°ì•„í•˜ê²Œ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•** ì´ë¼ëŠ” ë‚´ìš©ì˜ ë°œí‘œê°€ ë§¤ìš° ì¸ìƒì ì´ì—ˆìŠµë‹ˆë‹¤. `Suspense`ëŠ” ë¦¬ì•¡íŠ¸ì—ì„œ ì‹¤í—˜ì ìœ¼ë¡œ ê°œë°œë˜ê³  ìˆëŠ” Concurrent ëª¨ë“œì—ì„œ ì§€ì›í•˜ëŠ” ì¼ë¶€ ê¸°ëŠ¥ ì •ë„ë¡œ ì•Œê³ ìˆì—ˆëŠ”ë°, `Suspense`ë§Œ ë…ë¦½ì ìœ¼ë¡œ ì‚¬ìš©í•´ ë¹„ë™ê¸°ë¥¼ í˜¸ì¶œí•˜ëŠ” ì»´í¬ë„ŒíŠ¸ì— ë Œë”ë§ì„ ë¶„ê¸°í•  í•„ìš” ì—†ì´ ë¡œë”©ì²˜ë¦¬ë¥¼ ì™¸ë¶€ì— ìœ„ì„í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤. `Suspense`ë¥¼ ì‚¬ìš©í•˜ë©´ ë¡œë”©ì— ëŒ€í•œ ë Œë”ë§ ì²˜ë¦¬ë¥¼ ì„ ì–¸ì ìœ¼ë¡œ í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ë„ ìˆìŠµë‹ˆë‹¤. `ErrorBoundary`ë„ `Suspense`ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë°œìƒí•˜ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—ëŸ¬ì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ ì™¸ë¶€ì— ìœ„ì„í•˜ê³  ì„ ì–¸í˜•ìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.

```typescript
// detail page component
const ContentList = React.lazy(
  () => import("src/components/organisms/ContentList")
);
const Profile = React.lazy(() => import("src/components/organisms/Profile"));
const Overview = React.lazy(() => import("src/components/organisms/Overview"));
const CastList = React.lazy(() => import("src/components/organisms/CastList"));
const DetailPage: React.FC = () => {
  const { id, contentType } = useParams<{
    id: string;
    contentType: "movie" | "tv";
  }>();
  return (
    <ErrorBoundary> // í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë°œìƒí•œ ì—ëŸ¬ë¥¼ ìºì¹˜í•´ fallback UI ë Œë”ë§
      <Suspense fallback={<Loader />}> // suspenseë¡œ ê°ì‹¸ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ë“¤ì˜ Promiseê°€ íœë”© ì¤‘ì¸ ë™ì•ˆ Fallback Component ë Œë”ë§
        <Template profile={<Profile contentType={contentType} id={id} />}>
          <Overview contentType={contentType} id={id} />
          <CastList contentType={contentType} id={id} />
          <ContentList
            contentTitle="ë¹„ìŠ·í•œ ì‘í’ˆ"
            contentType={contentType}
            url={`${contentType}/${id}/similar`}
            wrap={true}
            titleFontSize={1.2}
          />
        </Template>
      </Suspense>
    </ErrorBoundary>
```

`ErrorBoundary`ì˜ ê²½ìš° ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ë„ í•¨ê»˜ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ `axios`ì—ì„œ `catch method`ì—ì„œ ì—ëŸ¬ê°€ ì²˜ë¦¬ë˜ê¸° ì „ì— `then`ì˜ ë‘ë²ˆì§¸ ì½œë°±í•¨ìˆ˜ë¡œ `Promise.reejct(err)`ë¥¼ ì „ë‹¬í–ˆê³ , `ErrorBoundary` ëŠ” ì „ë‹¬ë°›ì€ `error` ê°ì²´ë¥¼ `status`ì— ë”°ë¼ ë‹¤ë¥¸ ì—ëŸ¬ë©”ì‹œì§€ë¥¼ ìœ ì €ì—ê²Œ ë³´ì—¬ì¤„ ìˆ˜ ìˆë„ë¡ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

```typescript
class ErrorBoundary extends React.Component<
  {},
  { hasError: boolean; message: string; status: number }
> {
  constructor(props: {}) {
    super(props);
    this.state = { hasError: false, message: "", status: null };
  }

  componentDidCatch(error: AxiosError, info: React.ErrorInfo) {
    const { status } = error.response;
    this.setState({ hasError: true });
    this.setState({ status });
    if (status === 404) {
      this.setState({ message: "ìš”ì²­í•œ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ì–´ìš”." });
    } else if (status >= 401 && status <= 403) {
      this.setState({ message: "ë°ì´í„°ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê¶Œí•œì´ ì—†ì–´ìš”." });
    } else if (status >= 500) {
      this.setState({ message: "ì„œë²„ì— ë¬¸ì œê°€ ìƒê¸´ ê²ƒ ê°™ì•„ìš”." });
    } else {
      this.setState({ message: "í˜ì´ì§€ ë¡œë“œ ì¤‘ ë¬¸ì œê°€ ìƒê²¼ì–´ìš” ã… ã… " });
    }
  }

  render(): React.ReactNode {
    if (this.state.hasError) {
      return (
        <Wrapper>
          <Container>
            <Emoticon>ğŸ¤”</Emoticon>
            <Text color="red" fontSize={4} fontWeight={800}>
              {this.state.status}
            </Text>
            <Text>{this.state.message}</Text>
          </Container>
        </Wrapper>
      );
    }
    return this.props.children;
  }
}
```

![ì—ëŸ¬ í˜ì´ì§€](./src/images/errorpage_screenshot.png)

> ì°¸ê³ í•œ ë ˆí¼ëŸ°ìŠ¤
>
> [https://ko.reactjs.org/docs/concurrent-mode-suspense.html](https://ko.reactjs.org/docs/concurrent-mode-suspense.html)
>
> [https://ko.reactjs.org/docs/error-boundaries.html](https://ko.reactjs.org/docs/error-boundaries.html)

## ê·¸ì™¸ í”„ë¡œì íŠ¸ë¥¼ í†µí•´ ë°°ìš´ ì 

- hookì„ ì‚¬ìš©í•œ ì»´í¬ë„ŒíŠ¸ ìƒíƒœ ê´€ë¦¬
- Recoilì„ ì‚¬ìš©í•œ ì „ì—­ìƒíƒœ ê´€ë¦¬
- Styled Componentsë¥¼ ì‚¬ìš©í•œ CSS-in-JS ìŠ¤íƒ€ì¼ë§
- React dev tools ë¥¼ ì‚¬ìš©í•œ í”„ë¡œíŒŒì¼ë§ ë° ì„±ëŠ¥ ìµœì í™”
- ë¹„ë™ê¸° ë°ì´í„° ì²˜ë¦¬, ì—ëŸ¬ì— ëŒ€í•œ ì²˜ë¦¬
- React Routerë¡œ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë¼ìš°íŒ…
